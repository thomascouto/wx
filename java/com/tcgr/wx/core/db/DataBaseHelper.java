package com.tcgr.wx.core.db;import android.content.Context;import android.database.sqlite.SQLiteDatabase;import android.database.sqlite.SQLiteOpenHelper;import com.tcgr.wx.core.db.DbSchema.MetarSearchTable;import com.tcgr.wx.core.db.DbSchema.NotamTable;import com.tcgr.wx.core.db.DbSchema.RotaerTable;import com.tcgr.wx.core.db.DbSchema.TafSearchTable;/** * DataBaseHelper * <p> * Created by thomas on 23/12/15. */class DataBaseHelper extends SQLiteOpenHelper {    private static final int VERSION = 10;    private static final String DATABASE_NAME = "dataBaseWx.db";    public DataBaseHelper(Context context) {        super(context, DATABASE_NAME, null, VERSION);    }    @Override    public void onCreate(SQLiteDatabase db) {        db.execSQL("CREATE TABLE " + RotaerTable.NAME + "(" +                        RotaerTable.Cols.ICAO + " PRIMARY KEY, " +                        RotaerTable.Cols.CONTENT + " TEXT" +                        ")"        );        db.execSQL("CREATE TABLE " + NotamTable.NAME + "(" +                        NotamTable.Cols.ICAO + " PRIMARY KEY, " +                        NotamTable.Cols.CONTENT + " BLOB" +                        ")"        );        db.execSQL("CREATE TABLE " + MetarSearchTable.NAME + "(" +                        MetarSearchTable.Cols.ICAO + " TEXT PRIMARY KEY " +                        ")"        );        db.execSQL("CREATE TRIGGER metar_size_check AFTER INSERT ON " + MetarSearchTable.NAME + " " +                "WHEN (SELECT COUNT(icao) FROM " + MetarSearchTable.NAME + " ) > 5 " +                "BEGIN " +                "DELETE FROM " + MetarSearchTable.NAME + " WHERE rowid = (select min(rowid) FROM " + MetarSearchTable.NAME + ");" +                "END");        db.execSQL("CREATE TABLE " + TafSearchTable.NAME + "(" +                        TafSearchTable.Cols.ICAO + " TEXT PRIMARY KEY " +                        ")"        );        db.execSQL("CREATE TRIGGER taf_size_check AFTER INSERT ON " + TafSearchTable.NAME + " " +                "WHEN (SELECT COUNT(icao) FROM " + TafSearchTable.NAME + " ) > 5 " +                "BEGIN " +                "DELETE FROM " + TafSearchTable.NAME + " WHERE rowid = (select min(rowid) FROM " + TafSearchTable.NAME + ");" +                "END");    }    @Override    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {        db.execSQL("DROP TABLE IF EXISTS " + NotamTable.NAME);        db.execSQL("DROP TABLE IF EXISTS " + RotaerTable.NAME);        db.execSQL("DROP TABLE IF EXISTS " + MetarSearchTable.NAME);        db.execSQL("DROP TABLE IF EXISTS " + TafSearchTable.NAME);        onCreate(db);    }}